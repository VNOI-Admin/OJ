# Generated by Django 2.2.28 on 2022-07-15 18:21

from django.db import migrations, models


def update_testcase_result_visibility_mode(apps, schema_editor):
    Problem = apps.get_model('judge', 'Problem')
    Problem.objects.filter(allow_view_testcase_status=False).update(testcase_result_visibility_mode='S')


def reverse_update_testcase_result_visibility_mode(apps, schema_editor):
    Problem = apps.get_model('judge', 'Problem')
    Problem.objects.filter(testcase_result_visibility_mode='S').update(allow_view_testcase_status=False)


class Migration(migrations.Migration):

    dependencies = [
        ('judge', '0176_no_self_vote'),
    ]

    operations = [
        migrations.AddField(
            model_name='problem',
            name='testcase_result_visibility_mode',
            field=models.CharField(choices=[('A', 'Show all testcase result'), ('B', 'Show batch result only'), ('S', 'Show submission result only')], default='A', help_text='What testcase result should be showed to users?', max_length=1, verbose_name='Testcase result visibility'),
        ),

        migrations.RunPython(update_testcase_result_visibility_mode, reverse_update_testcase_result_visibility_mode),

        migrations.RemoveField(
            model_name='problem',
            name='allow_view_testcase_status',
        ),
    ]
